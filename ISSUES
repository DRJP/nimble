# A list of bugs, desired features, possible changes to the system, etc.
# please list with newest issues at the top

* (9/27/14 - from an old Perry email) What I've had in mind (for a long long time of thinking about this project :) ) is that we can have a compilation mode a little bit like "valgrind" for memory problems in R: one that does excessive computation to check for problems.  Specifically, we can compile to a "debugging" version of getLogProb that will always double check that the logProb value it is returning is in fact up to date with a new call to calculate.  That way we can validate an algorithm by execution, to some extent.

* (9/14/14) norm() in R and C nimble functions differ as the R default seems to be the "1" norm (the 'type' argument) and the C version is the Frobenius

* (9/14/14) gamma on my Linux desktop is finding (I think) the system gamma and somehow returning log(gamma(x)) instead of gamma(x); on my Mac, it's fine (CJP)

* (9/4/14)  allow *expressions* to be used as arguments to dmnorm(), nimArr_dmnorm_chol(), and all other multivariate distributions.

* (9/4/14)  handle for-loop indexes consistent with BUGS & jags.  e.g., for(i in 1:3+1) {}, should give lowest precendence to the ':' operator

* (8/11/14) deal more elegantly with metropolis samples that fall outside the domain of a parameter - e.g. proposals for positive valued parameters that are proposed to be negative

* (7/31/14) simulate(model, 'multivariateNodeName[1:10]') fails, because the multivariateNodeName is *incorrectly* expanded, none of which are names of model nodes

* (7/24/14) Using 'equals(a,b)' in a model definition, when both a, b are constants, (correctly) attempts to evaluate 'equals(a,b)' at compile-time, but this errors-out because 'equals' refers to function in testthat package, rather than the intended 'nimbleEquals()' function.

* (7/10/14) Revisit model-querying functions: e.g. getParents, get size infor from a model (extract from varInfo$maxes), others?

* (7/10/14) Revisit linear algebra functionality, e.g. svd, eigen, others?

* (7/10/14) Revisit use of `$` notation in the DSL.  This would break in normal R execution unless it is intercepted during nimbleFunction definition.

* (7/10/14) Make simulate() default to including deterministic dependencies

* (7/10/14) Multivariate default samplers. Multivariate conjugate samplers.

* (7/10/14) Revisit efficiency of processing of node sets, especially arising from newSetupCode.

* (7/10/14) Research CppAD/TMB/STAN code generation for automatic differentiation.

* (7/10/14) More profiling

* (7/10/14) Make run-time checking of Gibbs (conjugate) validity optional.

* (7/10/14) Possible bug from state-space model case: incorrect conjugacy determination.

* (7/10/14) Run some proper timing comparisons with MCMC suite, with run-time conjugate validity checking disabled.

* (7/10/14) 1D Laplace and AGQ

* (7/10/14) Generate "q" and "p" functions

* (7/10/14) Make multiple parameterizations of distributions and default parameters available from the DSL.  This could be a time to create a general way of handling R-like argument processing.

* (7/10/14) Fill in missing distributions

* (7/10/14) Censoring: dinterval, I(), T(), etc.

* (7/10/14) Fix gamma / lgamma issue on linux.

* (7/10/14) Make the inverse of as.matrix for a modelValues

* (7/10/14) Fix length(model[[var]])

* (6/27/14) possible error when compiling nf2 checks in functinalityChecks.R in manual directory

* (6/27/14) using 'step' in data block of bugs model fails because we now use nimbleStep, so not backwards compatible... minor issue we may want to ignore so as not to mask R's step

* (6/27/14) should we change nimbleStep to nimStep to be consistent with nimPrint, nimCopy, etc.?

* (6/26/14) might be nice to have a nodeNamesToVarNames function (and maybe the reverse?); I think this came up as Chris was trying to write a nf for the manual intro example 

* (6/22/14) add citations for our block RW (and maybe slice?) sampler algos in the manual

* (6/22/14) checking of pos-def for Chol, det, etc. and how to handle numerically non-p.d. matrices and pivoting

* (6/22/14) does Eigen really get det on original scale and then log; test for numerical issues with decent-size matrices

* (6/21/14) disable det,fact,gamma as numerically unstable?

* (6/21/14) check nimbleStep vs nimStep

* (6/20/14) additional helper fxns for manipulating models: getParents(), get size info from a model (extract from varInfo$maxes)

* (6/20/14) should we systematize how we handle dim/size of scalars? e.g., mv uses 1 and stuff on the R side in the model uses 0

* (6/19/14) handle initialization of nodes created by link functions - e.g. log(p) ~ dnorm() and a user initializes "p" but we need to initialize log_p as well

* (6/16/14) probably good to provide svd in DSL before long

* (6/16/14) change scalar | and & to || and && ?

* (6/16/14) do we want to replace 
nfMethod(targetRWSamplerFunction, 'generateProposalValue')()
with
targetRWSamplerFunction$generateProposalValue()

I guess this is the same issue as calculate(model, node) vs model$calculate(node)

* (6/11/14) add getPositions() functionality (DT)

* (6/9/14) NaN warnings in R for RW samplers that go beyond domain of a given parameter (e.g., negative proposals for positive-valued params)

* (6/8/14) (CP) eventually release our C/R new distribution functions (d and r functions) as a separate R pkg?

* (6/7/14) (DT) strange printout from MCMCspec(); using blocker as example with default spec, dnorm conjugacy message is formatted oddly (multiple "dependents_dnorm" and some ", ,":
[23] conjugate_norm sampler;   targetNode: d,  dependents_dnorm: c(\delta[1]\, \delta[2]\, \delta[3]\, \delta[4]\, \delta[5]\, , dependents_dnorm: \delta[6]\, \delta[7]\, \delta[8]\, \delta[9]\, \delta[10]\, , dependents_dnorm: \delta[11]\, \delta[12]\, \delta[13]\, \delta[14]\, \delta[15]\, , dependents_dnorm: \delta[16]\, \delta[17]\, \delta[18]\, \delta[19]\, \delta[20]\, , dependents_dnorm: \delta[21]\, \delta[22]\, \delta.new\)

* (6/7/14) (CP/DT) finish special case conj samplers, e.g. exp is gamma, unif is beta, chisq is gamma, etc.

* (6/7/14) (CP/DT) we might want a version of getNodeNames that returns nodes that are the top of the graph (those without any stochastic parents)

* (6/6/14) [DT] change MCMC to have two separate thinning intervals (rather than thin1=1, and thin2 artibrary)

* (6/5/14) add ability to deal with empty indices in calculate, simulate, etc., e.g.
calculate(model, 'x[i, ]') 

* [DT/CP] (6/5/14) transform DT's conjugacy check embedded within code with flag into packages/nimble/inst/tests/test-conjugacy.R

* (6/5/14) when compile a model get this warning:
Warning message:
In getPackageName(where) :
  Created a package name, ‘2014-06-05 08:24:46’, when none found

* (6/5/14) calculate and simulate do not allow empty indexing, unlike get and setting values of nodes:
Cmodel[['y[1,]']] is fine
calculate(Cmodel, 'y[1,]') is not 

* (6/5/14) should we have returnModel=TRUE be the default for BUGSmodel()?

* (6/5/14) (DT/CP) desire to use 'constants' in 'dimensions' argument, e.g: BUGSmodel(model, constants = list(N = 5), dimensions = list(x = c(N,N))); DT had this and removed it as it was causing some other problem; might revisit this

* (6/5/14) we may want that compileNimbleFunction by default should  just compile a single function as this is the easiest to explain to a new user rather than having to go into the fact that there may be multiple instances right off the bat

* (6/12/14) (DT) checkConjugacy() will complain in multivariate case, when there are 'replacement' expressions in 'codeReplacedWithValues', which do not represent stochastic model nodes.

* (6/13/14) (PDV) correct/consistent handling of is.na() and is.nan() in cpp

* (6/13/14) (DT/PDV) handling cases (e.g., dipper) with nodes defined more than once
